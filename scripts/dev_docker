# Optional: pass in a timezone as first argument
# If not given will attempt to mount /etc/localtime

# If current pwd is scripts, go 1 up.
if [ ${PWD##*/} == "scripts" ]; then
    cd ..
fi

docker build -t home-assistant-dev .

# TODO set device via command line, remove /bin/bash

if [ $# -gt 0 ]
then
  docker run \
    --net=host \
    -e "TZ=$1" \
    --device=/dev/bus/usb/002:/usbstick:rwm \
    -v `pwd`:/usr/src/app \
    -v `pwd`/config:/config \
    -t -i home-assistant-dev \
    /bin/bash

else
  docker run \
    --net=host \
    -v /etc/localtime:/etc/localtime:ro \
    -v `pwd`:/usr/src/app \
    -v `pwd`/config:/config \
    -t -i home-assistant-dev

fi
