<link rel="import" href="../bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../bower_components/core-icon/core-icon.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tab.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-menu-button/paper-menu-button.html">
<link rel="import" href="../bower_components/paper-dropdown/paper-dropdown.html">
<link rel="import" href="../bower_components/core-menu/core-menu.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">

<link rel="import" href="../layouts/partial-states.html">

<polymer-element name="home-assistant-main" attributes="api">
  <template>
    <style>

      core-header-panel {
        -webkit-overflow-scrolling: touch;
        background-color: #E5E5E5;
      }

      core-toolbar {
        background: #03a9f4;
        color: white;
      }

      core-toolbar.tall {
        /* 2x normal height */
        height: 128px;
      }

      core-toolbar .bottom {
        opacity: 0;
        transition: opacity 0.30s ease-out;
      }

      core-toolbar.tall .bottom {
        opacity: 1;
      }

      paper-tab {
        text-transform: uppercase;
      }

      paper-menu-button {
        margin-top: 5px !important;
      }

      paper-dropdown {
        border-radius: 3px;        
      }

      paper-dropdown .menu {
        margin: 0;
        padding: 8px 0;
        color: black;
      }

      paper-item {
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
      }

      paper-item a {
        text-decoration: none;
      }

    </style>

    <core-header-panel fit>

      <core-toolbar>
        <div flex>Home Assistant</div>
        <paper-icon-button icon="refresh"
          on-click="{{handleRefreshClick}}"></paper-icon-button>
        <paper-icon-button icon="assessment"
          on-click="{{handleHistoryClick}}"></paper-icon-button>

        <paper-menu-button>
          <paper-icon-button icon="more-vert" noink></paper-icon-button>
          <paper-dropdown halign="right" duration="200" class="dropdown">
            <core-menu class="menu">
              <paper-item>
                <a on-click={{handleServiceClick}}>
                  <!-- <core-icon icon="settings-remote"></core-icon> -->
                  Call Service
                </a>
              </paper-item>
              <paper-item>
                <a on-click={{handleAddStateClick}}>
                  Set State
                </a>
              </paper-item>
              <paper-item>
                <a on-click={{handleEventClick}}>
                  Trigger Event
                </a>
              </paper-item>
              <paper-item>
                <a on-click={{handleLogOutClick}}>
                  <!-- <core-icon icon="exit-to-app"></core-icon> -->
                  Log Out
                </a>
              </paper-item>
            </core-menu>
          </paper-dropdown>
        </paper-menu-button>
      </core-toolbar>

      <partial-states></partial-states>
    </core-header-panel>

  </template>
  <script>
  Polymer({

    handleRefreshClick: function() {
      window.hass.syncActions.sync();
    },

    handleHistoryClick: function() {
      window.hass.uiActions.showHistoryDialog();
    },

    handleEventClick: function() {
      window.hass.uiActions.showFireEventDialog();
    },

    handleServiceClick: function() {
      window.hass.uiActions.showCallServiceDialog();
    },

    handleAddStateClick: function() {
      window.hass.uiActions.showSetStateDialog();
    },

    handleLogOutClick: function() {
      window.hass.authActions.logOut();
    },

  });
  </script>  
</polymer-element>
