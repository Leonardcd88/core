<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="../bower_components/paper-date-picker/paper-date-picker-dialog.html">

<link rel="import" href="../dialogs/more-info-dialog.html">

<dom-module id="modal-manager">
  <template>
    <more-info-dialog id="moreInfoDialog"></more-info-dialog>
    <paper-date-picker-dialog id="datePicker"
      on-value-changed='datePickerValueChanged'></paper-date-picker-dialog>
  </template>
</dom-module>

<script>
(function() {
  var moreInfoGetters = window.hass.moreInfoGetters;
  var uiActions = window.hass.uiActions;

  Polymer({
    is: 'modal-manager',

    behaviors: [nuclearObserver],

    properties: {
      moreInfoEntityId: {
        type: String,
        observer: 'moreInfoEntityIdChanged',
        bindNuclear: moreInfoGetters.currentEntityId,
      },
      datePickerCallback: {
        type: Function,
        value: null,
      },
    },

    moreInfoEntityIdChanged: function(newVal) {
      if (newVal) {
        this.$.moreInfoDialog.show(newVal);
      }
    },

    ready: function() {
      uiActions.showDatePicker = function(dateSelectedCallback, startDate) {
        this.datePickerCallback = dateSelectedCallback;
        this.$.date = startDate;
        this.$.datePicker.toggle();
      }.bind(this);
    },

    datePickerValueChanged: function(ev) {
      this.datePickerCallback(ev.target.value);
    },
  });
})();
</script>
