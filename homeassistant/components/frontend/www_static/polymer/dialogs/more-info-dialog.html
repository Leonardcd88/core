<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="ha-action-dialog.html">
<link rel="import" href="../cards/state-card-content.html">
<link rel="import" href="../components/state-timeline.html">
<link rel="import" href="../more-infos/more-info-content.html">

<polymer-element name="more-info-dialog">
<template>
  <ha-action-dialog id="dialog">
    <style>
    .title-card {
      margin-bottom: 24px;
    }
    </style>

    <div>
      <state-card-content stateObj="{{stateObj}}" class='title-card'>
      </state-card-content>
      <state-timeline stateObj="{{stateObj}}"></state-timeline>
      <more-info-content stateObj="{{stateObj}}"></more-info-content>
    </div>
  </ha-action-dialog>

</template>
<script>
Polymer({
  stateObj: {},

  observe: {
    'stateObj.attributes': 'reposition'
  },

  /**
   * Whenever the attributes change, the more info component can
   * hide or show elements. We will reposition the dialog.
   */
  reposition: function(oldVal, newVal) {
    // Only resize if already open
    if(this.$.dialog.opened) {
      this.job('resizeAfterLayoutChange', function() {
        this.$.dialog.resizeHandler();
      }.bind(this), 1000);
    }
  },

  show: function(stateObj) {
    this.stateObj = stateObj;
    this.job('showDialogAfterRender', function() {
      this.$.dialog.toggle();
    }.bind(this));
  },

});
</script>
</polymer-element>
